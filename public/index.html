<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Pakistan Train Tracker - Mobile</title>
    <link rel="stylesheet" href="mobile-styles.css?v=1729607000">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body class="mobile-app">
    <div class="mobile-app">
        <!-- Sticky Header for Home -->
        <div class="sticky-header">
            <div class="header-content-sticky">
                <div class="app-logo-sticky">
                    <div class="logo-circle-sticky">🚂</div>
                    <div class="app-info-sticky">
                        <h1>Train Tracker</h1>
                        <div class="tagline-sticky">Live Pakistan Railways</div>
                    </div>
                </div>
                <div class="header-right-actions">
                    <button class="header-icon-btn notification-btn">
                        <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span class="notification-badge"></span>
                    </button>
                    <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                        <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Last Updated Header for Home -->
            <div class="last-updated-header home-last-updated">
                <span id="homeLastUpdated">Last updated: Just now</span>
            </div>

            <!-- Stats Overview -->
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-icon">
                        <img src="/locomotive_1f682.png" alt="Train" class="stat-locomotive-icon" />
                    </div>
                    <div class="stat-number" id="activeTrainsCount">--</div>
                    <div class="stat-label">Active</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg class="stat-svg clock-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 7v5l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 3v1M12 20v1M3 12h1M20 12h1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="stat-number" id="onTimeTrains">--</div>
                    <div class="stat-label">On Time</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg class="stat-svg alert-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <circle cx="12" cy="17" r="0.5" fill="currentColor" stroke="currentColor"/>
                        </svg>
                    </div>
                    <div class="stat-number" id="delayedTrains">--</div>
                    <div class="stat-label">Delayed</div>
                </div>
            </div>

            <!-- Feature Grid -->
            <div class="feature-grid">
                <div class="feature-tile primary" onclick="mobileApp.navigateToScreen('liveTracking')">
                    <div class="tile-header">
                        <div class="tile-icon">🚂</div>
                        <div class="live-indicator">LIVE</div>
                    </div>
                    <h3>Live Tracking</h3>
                    <p>Track trains in real-time with live positions and updates</p>
                </div>
                <div class="feature-tile secondary" onclick="mobileApp.navigateToScreen('scheduleScreen')">
                    <div class="tile-header">
                        <div class="tile-icon">📅</div>
                    </div>
                    <h3>Schedules</h3>
                    <p>Browse train schedules and departure times</p>
                </div>
                <div class="feature-tile tertiary" onclick="mobileApp.navigateToScreen('stationScreen')">
                    <div class="tile-header">
                        <div class="tile-icon">🚉</div>
                    </div>
                    <h3>Stations</h3>
                    <p>Find station information and train arrivals</p>
                </div>
                <div class="feature-tile quaternary" onclick="mobileApp.navigateToScreen('mapScreen')">
                    <div class="tile-header">
                        <div class="tile-icon">🗺️</div>
                    </div>
                    <h3>Live Map</h3>
                    <p>View trains on interactive map</p>
                </div>
            </div>
            <!-- Quick Train Access -->
            <div class="quick-train-access">
                <div class="section-header">
                    <h3>Live Trains</h3>
                    <button class="view-all-btn" onclick="mobileApp.navigateToScreen('liveTracking')">View All</button>
                </div>
                <div class="train-carousel" id="liveTrainsList">
                    <div class="loading">Loading live trains...</div>
                </div>
                <div class="carousel-dots" id="carouselDots"></div>
            </div>


            <!-- Live Updates -->
            <div class="live-updates">
                <div class="section-header">
                    <h3>Live Updates</h3>
                    <div class="update-indicator">
                        <div class="pulse-dot"></div>
                        <span>Real-time</span>
                    </div>
                </div>
                <div class="updates-feed" id="liveUpdatesFeed">
                    <div class="update-item">
                        <div class="update-status on-time"></div>
                        <div class="update-content">
                            <div class="update-title">Karachi Express</div>
                            <div class="update-details">Arrived at Lahore Junction</div>
                            <div class="update-time">2 minutes ago</div>
                        </div>
                    </div>
                    <div class="update-item">
                        <div class="update-status delayed"></div>
                        <div class="update-content">
                            <div class="update-title">Green Line</div>
                            <div class="update-details">Running 15 minutes late</div>
                            <div class="update-time">5 minutes ago</div>
                        </div>
                    </div>
                    <div class="update-item">
                        <div class="update-status arrived"></div>
                        <div class="update-content">
                            <div class="update-title">Business Express</div>
                            <div class="update-details">Departed from Islamabad</div>
                            <div class="update-time">8 minutes ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Footer -->
        <div class="mobile-footer">
            <p>Pakistan Railways Live Tracking System</p>
        </div>

        <!-- Screens -->
        <div class="screens">
            <!-- Dashboard Screen -->
            <div id="dashboard" class="screen hidden">
                <div class="screen-header">
                    <button class="back-btn" onclick="mobileApp.goBack()">←</button>
                    <h2>Dashboard</h2>
                    <button class="refresh-btn" onclick="mobileApp.loadDashboardData()">🔄</button>
                </div>

                <div class="screen-content">
                    <!-- Dashboard Stats -->
                    <div class="dashboard-stats">
                        <div class="stat-card primary">
                            <div class="stat-icon">🚂</div>
                            <div class="stat-content">
                                <div class="stat-value" id="dashboardActiveTrains">0</div>
                                <div class="stat-label">Active Trains</div>
                            </div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-icon">✅</div>
                            <div class="stat-content">
                                <div class="stat-value" id="dashboardOnTime">0</div>
                                <div class="stat-label">On Time</div>
                            </div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-icon">⏰</div>
                            <div class="stat-content">
                                <div class="stat-value" id="dashboardDelayed">0</div>
                                <div class="stat-label">Delayed</div>
                            </div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-icon">🚉</div>
                            <div class="stat-content">
                                <div class="stat-value" id="dashboardStations">0</div>
                                <div class="stat-label">Stations</div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="section-header">
                        <h3>Quick Actions</h3>
                    </div>
                    <div class="quick-actions-grid">
                        <div class="action-card" onclick="mobileApp.navigateToScreen('liveTracking')">
                            <div class="action-icon">🚂</div>
                            <div class="action-text">Live Trains</div>
                        </div>
                        <div class="action-card" onclick="mobileApp.navigateToScreen('scheduleScreen')">
                            <div class="action-icon">📅</div>
                            <div class="action-text">Schedules</div>
                        </div>
                        <div class="action-card" onclick="mobileApp.navigateToScreen('stationScreen')">
                            <div class="action-icon">🚉</div>
                            <div class="action-text">Stations</div>
                        </div>
                        <div class="action-card" onclick="mobileApp.navigateToScreen('mapScreen')">
                            <div class="action-icon">🗺️</div>
                            <div class="action-text">Live Map</div>
                        </div>
                    </div>

                    <!-- Recent Trains -->
                    <div class="section-header">
                        <h3>Recent Trains</h3>
                        <button class="view-all-btn" onclick="mobileApp.navigateToScreen('liveTracking')">View All</button>
                    </div>
                    <div class="recent-trains" id="dashboardRecentTrains">
                        <div class="loading">Loading recent trains...</div>
                    </div>
                </div>
            </div>

            <!-- Live Tracking Screen -->
            <div id="liveTracking" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Live Tracking</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn refresh-btn" onclick="mobileApp.loadLiveTrains()">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" id="darkModeToggleLive" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="last-updated-header">
                    <span id="liveTrackingLastUpdated">Last updated: Just now</span>
                </div>

                <div class="search-panel">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <span class="search-icon">🔍</span>
                            <input type="text" id="liveTrackingSearchInput" placeholder="Search live trains by number, name, or location..." class="search-input">
                            <button class="clear-search-btn" id="clearLiveTrackingSearch" onclick="mobileApp.clearLiveTrackingSearch()" style="display: none;">✕</button>
                        </div>
                    </div>
                    <div class="search-results-info" id="liveTrackingSearchResults" style="display: none;">
                        Found 0 trains matching your search
                    </div>
                </div>

                <div class="screen-content">
                    <div class="schedule-results">
                        <div class="results-header">
                            <h3>Live Trains</h3>
                            <div class="results-count" id="liveTrackingResultsCount">Loading...</div>
                        </div>
                        <div class="live-trains-list" id="liveTrainsListDetail">
                            <div class="loading">Loading live trains...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Train Details Screen -->
            <div id="liveTrainDetail" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Train Details</h2>
                            <div class="header-clock" id="trainDetailClock">--:--:-- --</div>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn refresh-btn" onclick="mobileApp.refreshTrainDetails()">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="last-updated-header">
                    <span id="trainDetailLastUpdated">Last updated: Just now</span>
                </div>

                <div class="train-detail-content">
                    <!-- Train Status Card -->
                    <div class="train-status-card">
                        <div class="train-title">
                            <h3 id="trainDetailName">Loading...</h3>
                            <div class="train-number" id="trainDetailNumber">--</div>
                        </div>
                        <div class="status-indicator">
                            <div class="status-dot"></div>
                            <span class="live-indicator">LIVE</span>
                        </div>
                    </div>

                    <!-- Train Metrics -->
                    <div class="train-metrics">
                        <div class="metric-card">
                            <div class="metric-icon">⚡</div>
                            <div class="metric-value" id="trainSpeed">-- km/h</div>
                            <div class="metric-label">Speed</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">⏰</div>
                            <div class="metric-value" id="trainDelay">--</div>
                            <div class="metric-label">Delay</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">📍</div>
                            <div class="metric-value" id="nextStation">--</div>
                            <div class="metric-label">Next Station</div>
                        </div>
                    </div>

                    <!-- Journey Map -->
                    <div class="journey-map">
                        <div class="route-progress" id="routeProgress">
                            <div class="route-stations" id="routeStations">
                                <!-- Stations and route line will be populated dynamically -->
                                <div class="loading">Loading route stations...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Station Route Section -->
                    <div class="station-route-section">
                        <h3>🚉 Route Stations</h3>
                        <div class="station-route-list" id="stationRouteList">
                            <div class="loading">Loading route stations...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map Screen -->
            <div id="mapScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Live Map</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="map-container">
                    <div id="liveMap" style="height: 100%; width: 100%; border-radius: 12px;"></div>
                </div>
                
                <!-- Train Selection Panel -->
                <div class="train-selection-panel" id="trainSelectionPanel">
                    <div class="panel-header">
                        <h3>Select Train to Track</h3>
                        <button class="close-panel-btn" onclick="mobileApp.closeTrainSelection()">×</button>
                    </div>
                    <div class="train-list" id="trainList">
                        <div class="loading">Loading active trains...</div>
                    </div>
                </div>
                
                <!-- Train Info Panel -->
                <div class="train-info-panel" id="trainInfoPanel" style="display: none;">
                    <div class="panel-header">
                        <h3 id="selectedTrainName">Train Information</h3>
                        <button class="close-panel-btn" onclick="mobileApp.closeTrainInfo()">×</button>
                    </div>
                    <div class="train-stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">Speed</div>
                            <div class="stat-value" id="trainSpeed">-- km/h</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Status</div>
                            <div class="stat-value" id="trainStatus">--</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Next Station</div>
                            <div class="stat-value" id="nextStation">--</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">ETA</div>
                            <div class="stat-value" id="trainETA">--</div>
                        </div>
                    </div>
                    <div class="route-progress">
                        <div class="progress-header">
                            <span id="originStation">Origin</span>
                            <span id="progressPercent">0%</span>
                            <span id="destinationStation">Destination</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressBar" style="width: 0%">
                                <span id="progressText">0% Complete</span>
                            </div>
                            <div class="train-icon" id="trainIcon" style="left: 0%">🚂</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Station Search Screen -->
            <div id="stationScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Station Search</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="station-search">
                    <div class="search-input">
                        <input type="text" id="stationSearchInput" class="station-search-input" placeholder="Search for station...">
                        <button class="search-btn-small" onclick="mobileApp.searchStations()">🔍</button>
                    </div>
                </div>

                <div class="screen-content">
                    <!-- Major Stations -->
                    <div class="section-header">
                        <h3>Major Stations</h3>
                    </div>
                    <div class="major-stations" id="majorStations">
                        <div class="loading">Loading major stations...</div>
                    </div>

                    <div class="station-results" id="stationResults">
                        <div class="empty-state">
                            <p>🚉 Enter a station name to search</p>
                            <p>Find departures, arrivals, and station information</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Train Search Screen -->
            <div id="trainSearchScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Train Search</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="search-section">
                    <div class="route-selector">
                        <div class="input-group">
                            <input type="text" id="trainSearchInput" class="station-input" placeholder="Search by train number or name...">
                            <button class="search-btn" onclick="mobileApp.searchTrains()">🔍</button>
                        </div>
                    </div>
                </div>

                <div class="screen-content">
                    <div class="search-results" id="trainSearchResults">
                        <div class="empty-state">
                            <p>🚂 Enter train number or name to search</p>
                            <p>Find schedules, routes, and live tracking</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Screen -->
            <div id="scheduleScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Train Schedule</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="last-updated-header">
                    <span id="scheduleLastUpdated">Last updated: Just now</span>
                </div>

                <div class="search-panel">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <span class="search-icon">🔍</span>
                            <input type="text" id="scheduleSearchInput" placeholder="Search trains by number, name, or route..." class="search-input">
                            <button class="clear-search-btn" id="clearSearchBtn" onclick="mobileApp.clearScheduleSearch()" style="display: none;">✕</button>
                        </div>
                    </div>
                </div>

                <div class="screen-content">
                    <div class="schedule-results">
                        <div class="results-header">
                            <h3>Available Trains</h3>
                            <div class="results-count">Loading...</div>
                        </div>
                        <div class="schedule-train-list" id="scheduleList">
                            <div class="loading">Loading schedule...</div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Schedule Details Screen -->
            <div id="scheduleDetailsScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Schedule Details</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="train-detail-content">
                    <!-- Combined Train Info and Route Card -->
                    <div class="train-status-card combined-card">
                        <div class="train-header-section">
                            <div class="train-main-title">
                                <h3 id="scheduleTrainName">Loading...</h3>
                                <div class="train-badges">
                                    <div class="train-number" id="scheduleTrainNumber">--</div>
                                    <div class="status-indicator">
                                        <div class="status-dot"></div>
                                        <span class="schedule-indicator">SCHEDULE</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="route-info-section">
                            <div class="route-info">
                                <div class="route-station origin">
                                    <span class="station-text">Origin: <span id="scheduleOrigin">Loading...</span> <span id="scheduleDepartureTime">--:--</span></span>
                                </div>
                                <div class="route-station destination">
                                    <span class="station-text">Destination: <span id="scheduleDestination">Loading...</span> <span id="scheduleArrivalTime">--:--</span></span>
                                </div>
                            </div>
                            <div class="journey-duration">
                                <span>Journey Duration: <span id="journeyDuration">31h 0m</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Station Route Section -->
                    <div class="station-route-section">
                        <h3>🚉 All Stations</h3>
                        <div class="station-route-list" id="scheduleStationList">
                            <div class="loading">Loading station schedule...</div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Profile Screen -->
            <div id="profileScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Profile & Settings</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="screen-content">
                    <div class="station-info-card">
                        <div class="station-header">
                            <h3>🚂 Train Tracker</h3>
                            <div class="station-status">
                                <div class="status-dot"></div>
                                <span>Active</span>
                            </div>
                        </div>
                        <div class="station-details">
                            <div class="detail-item">
                                <div class="detail-label">Version</div>
                                <div class="detail-value">1.0.0</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Last Updated</div>
                                <div class="detail-value" id="appLastUpdate">--</div>
                            </div>
                        </div>
                    </div>

                    <div class="station-info-card">
                        <div class="station-header">
                            <h3>⚙️ Settings</h3>
                        </div>
                        <div class="station-details">
                            <div class="detail-item">
                                <div class="detail-label">Auto Refresh</div>
                                <div class="detail-value">
                                    <label class="toggle">
                                        <input type="checkbox" id="autoRefreshToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Push Notifications</div>
                                <div class="detail-value">
                                    <label class="toggle">
                                        <input type="checkbox" id="notificationsToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="station-info-card">
                        <div class="station-header">
                            <h3>ℹ️ About</h3>
                        </div>
                        <p class="detail-label">
                            Pakistan Train Tracker provides real-time train tracking and schedule information for Pakistan Railways. 
                            Track trains live, view schedules, and get station information.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Favorites Screen -->
            <div id="favoritesScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Favorite Trains</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="screen-content">
                    <div class="favorites-list" id="favoritesList">
                        <div class="empty-state">
                            <p>⭐ No favorite trains yet</p>
                            <p>Tap the star on any train to add it to favorites</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Route Details Screen -->
            <div id="routeScreen" class="screen hidden">
                <div class="sticky-header">
                    <div class="header-content-sticky">
                        <button class="header-icon-btn back-btn" onclick="mobileApp.goBack()">
                            <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="header-title-section">
                            <h2>Route Details</h2>
                        </div>
                        <div class="header-right-actions">
                            <button class="header-icon-btn notification-btn">
                                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span class="notification-badge"></span>
                            </button>
                            <button class="header-icon-btn dark-mode-btn" onclick="mobileApp.toggleDarkMode()">
                                <svg class="icon-svg moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="screen-content">
                    <div class="route-detail-content">
                        <div class="route-details" id="routeDetails">
                            <div class="loading">Loading route details...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="mobileApp.navigateToScreen('home')" data-nav="home">
                <span class="nav-icon">🏠</span>
                <span class="nav-label">Home</span>
            </div>
            <div class="nav-item" onclick="mobileApp.navigateToScreen('liveTracking')" data-nav="track">
                <span class="nav-icon">🚂</span>
                <span class="nav-label">Track</span>
            </div>
            <div class="nav-item" onclick="mobileApp.navigateToScreen('trainSearchScreen')" data-nav="search">
                <span class="nav-icon">🔍</span>
                <span class="nav-label">Search</span>
            </div>
            <div class="nav-item" onclick="mobileApp.navigateToScreen('favoritesScreen')" data-nav="favorites">
                <span class="nav-icon">⭐</span>
                <span class="nav-label">Favorites</span>
            </div>
            <div class="nav-item" onclick="mobileApp.navigateToScreen('profileScreen')" data-nav="profile">
                <span class="nav-icon">👤</span>
                <span class="nav-label">Profile</span>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <!-- Capacitor Scripts -->
    <script type="module" src="capacitor.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="config.js"></script>
    <script src="mobile-app.js"></script>
</body>
</html>